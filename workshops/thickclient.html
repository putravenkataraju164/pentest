<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title></title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="../pkg/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
	mark {
	  background-color: #52BE80;
	}
  </style>
  <script src="../gif/webcomponentsjs/webcomponents-loader.js"></script>
  <script src="../gif/gif-player.es5.js" defer async></script>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="re101"
                  title="Thick Client Pentesting"
                  environment="web"
                  feedback-link="">


      <google-codelab-step label="Intro" duration="5">
			<h2 is-upgraded>Thick Client</h2>
      <ul>
      <li>A <b>Thick </b>/ <b>Heavy </b>/ <b>Rich </b>or <b>Fat</b> client is a computer client in client–server architecture or networks, that typically provides rich functionality independent of the central server.</li>
      </ul>
      <h2 is-upgraded>Advantages</h2>
			<ul>
			<li>Lower server requirements</li>
			<li>Working offline</li>
			<li>Better multimedia performance</li>
			<li>More flexibility</li>
			<li>Using existing infrastructure</li>
			<li>Higher server capacity</li>
			</ul>
			<h2 is-upgraded>Introduction</h2>
			<ul>
			<li>Thick client applications have been around for many years and can still be found within a variety of organizations – across industries and sizes. Due to the adoption of hybrid infrastructure architecture, thick-client applications can become a better target for attackers.</li>
			<li>Thick client pentesting involves both local and server-side processing and often uses proprietary protocols for communication.</li>
			<li>Simple automated assessment scanning is not sufficient and testing thick client applications requires a lot of patience and a methodical approach. Moreover, the process often requires specialized tools and custom testing setup.</li>
			<li>Thick client testing can be exciting for pentesters because the attack surface of these applications can be significant.</li>
      </ul>
      <aside class="special"><strong>Note:</strong> Unlike web applications or infrastructure pentests, thick client pentests have a more notable success rate because the client is available locally and, hence, critical vulnerabilities may be found during the engagements.</aside>
      <ul>
		Thick client applications can be developed using various programming languages such as:
        <li>.Net</li>
        <li>Java</li>
        <li>C/C++</li>
        <li>Microsoft Silverlight</li>
		<li>Delphi Pascal</li>
      </ul>
      </google-codelab-step>
      <google-codelab-step label="Architecture" duration="5">
        There are two types of architectures
        <p><b>Two-Tier architecture</b></p>
        <p>In two-tier architecture, the thick client application implements a client-to-server communication. The application is installed on the client computer and, in order to work, will need to communicate with a database server. For example, imagine an HR application that was installed on the client computer and, in order to retrieve the employees’ information, communicates directly with the HR database server.</p>
        <p class="image-container"><img src="../tc/tc1.jpg" alt="Two Tier Architecture"></p>
        <p><b>Three-Tier architecture</b></p>
        <p>In three-tier architecture, the client communicates with an application server, which in turn talks to the database in a manner similar to a regular web application. The most common communication method in these applications may be carried out using HTTP/HTTPS.</p>
        <p>Three-tier architecture has a security advantage over two-tier architecture, because it prevents the end-user from communicating directly with the database server.</p>
        <p class="image-container"><img src="../tc/tc2.jpg" alt="Three Tier Architecture"></p>
      </google-codelab-step>
     
      <google-codelab-step label="Pentesting Thick Client" duration="5">
        <p>Thick client applications are generally more complicated and customized than web or mobile applications, so they need a specific approach when it comes to a penetration test. The first steps to take when facing a thick client application is to gather information, such as:</p>
        <ul>
        <li>Discovering what technologies are being used on both the client and the server sides.</li>
        <li>Figuring out the application’s functionality and behavior.</li>
        <li>Identifying all of the different entry points for user input.</li>
        <li>Understanding the core security mechanisms used by the application.</li>
        <li>Identifying common vulnerabilities like languages and frameworks.</li>
        </ul>
        </ul>
      </google-codelab-step>
      <google-codelab-step label="Environment Setup" duration="30">
        <p>In this workshop we are going to use Flare VM developed by <a href="https://www.fireeye.com/blog/threat-research/2017/07/flare-vm-the-windows-malware.html">Fireeye</a> cyber security experts.</p>
        <ul>
        <li>FLARE VM is a freely available and open sourced Windows-based security distribution designed for reverse engineers, malware analysts, incident responders, forensicators, and penetration testers. Inspired by open-source Linux-based security distributions like Kali Linux, REMnux and others</li>
        <li>FLARE VM delivers a fully configured platform with a comprehensive collection of Windows security tools such as debuggers, disassemblers, decompilers, static and dynamic analysis utilities, network analysis and manipulation, web assessment, exploitation, vulnerability assessment applications, and many others.</li>
        <li>The distribution also includes the FLARE team’s public malware analysis tools such as FLOSS and FakeNet-NG.</li>
        </ul>
       <aside class="special">In this section you will be setting up a virtual environment.</aside>
       <h2 is-upgraded>Installing VirtualBox</h2>
       <p>Click the icons below to download the version of Virtualbox for your OS.</p>
       <table>
       <tr><td colspan="1" rowspan="1"><p><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank"><paper-button class="colored" raised>Windows VirtualBox</paper-button></a></p>
       </td><td colspan="1" rowspan="1"><p><a href="https://www.virtualbox.org/wiki/Linux_Downloads" target="_blank"><paper-button class="colored" raised>Linux VirtualBox</paper-button></a></p>
       </td><td colspan="1" rowspan="1"><p><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank"><paper-button class="colored" raised>MacOS VirtualBox</paper-button></a></p>
       </td></tr>
       </table>
       <h2 is-upgraded>Manual Setup instructions</h2>
       <h3>Install Windows 10 in Virtual Box</h3>
       <pre><code>Do not forget to install "Virtual Box Guest Additions" and Take 1st snapshot</code></pre>
       <aside class="special">Goto <code>Machine</code> tab and then select <code>Take Snapshot</code> to take a snapshot of current windows state</aside>
       <h3>Installing Flare VM Tools</h3>
       <table>
       <tr><td colspan="1" rowspan="1"><p><a href="https://www.fireeye.com/blog/threat-research/2018/11/flare-vm-update.html" target="_blank"><paper-button class="colored" raised>Fireeye Setup</paper-button></a></p>
       </td><td colspan="1" rowspan="1"><p><a href="https://github.com/fireeye/flare-vm" target="_blank"><paper-button class="colored" raised>Fireeye Github Repo</paper-button></a></p>
       </td></tr>
       </table>
       <ol><b>Flare VM installation process</b>
         <li>Download the Flarevm github repository from above link in Windows 7 VM</li>
         <li>Open <code>powershell</code> as administrator and Change execution policy to Unrestricted <code>Set-ExecutionPolicy Unrestricted</code></li>
         <li>Navigate to flarevm repository and run the <code>.\install.ps1</code> from powershell, enter windows password when prompted</li>
       </ol>
       <pre><code>After installation of Flare VM tools take 2nd snapshot</pre></code>
       <h2 is-upgraded>DVTA Setup instructions</h2>
       <h3>Follow Github repositiory <a href=https://github.com/srini0x00/dvta" target="_blank">https://github.com/srini0x00/dvta</a> to setup DVTA for practice</h3>
     </google-codelab-step>
      <google-codelab-step label="Static Analysis" duration="15">
       <ul>
          <li>Insecure Local Storage</li>
          <input type="checkbox" id="" name="">
          <label for="">Check all files in applicaiton installation directory for Hard coded sensitive information</label>
          <li>Insecure Logging of Data</li>
          <input type="checkbox" id="" name="">
          <label for="">Check all files in temporary directory and in C drive Appdata for sensitive data</label>
          <li>Weak Configuration / Security Misconfiguration</li>
          <input type="checkbox" id="" name="">
          <label for="">Test to check if any coinfiguration files contains sensitive values (example: encryption=true)</label>
          <li>Binary's and DLL's are not Signed</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Weak Code Quality or Lack of Code Obfuscation</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>SSL / TLS support</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
        </ul>
      </google-codelab-step>
      <google-codelab-step label="Dynamic Analysis" duration="15">
        <ul>
          <li>Unencrypted communication</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Sensitive data in Memory Dump</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Intercept </li>Echo mirage
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Injection - XSS, CSV and SQL Injections</li>        
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>DLL Hijacking</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
		      <li>Error Handling</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Broken Access Control</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
		      <li>Business Logic Bypasses</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Session Management</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>Automatic session termination / Everytime same session token is generated
          <li>File Uploads and File system access</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>
          <li>Reverse Engineering (Debugging and Decompling)</li>
          <input type="checkbox" id="" name="">
          <label for=""></label>x64dbg / WinDBG / Gidhra 
          Authentication bypass / Privledge Escalation 
		</ul>
      </google-codelab-step>
      <google-codelab-step label="Demo" duration="20">
        
      </google-codelab-step>
 </google-codelab>

  <script src="../pkg/native-shim.js"></script>
  <script src="../pkg/custom-elements.min.js"></script>
  <script src="../pkg/prettify.js"></script>
  <script src="../pkg/codelab-elements.js"></script>


</body>
</html>
